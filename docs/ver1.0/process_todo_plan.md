# プロセス指向ToDoアプリ 開発計画

## 前提・設計原則（コンテキスト/仮定）
- **スコープ**：案件ごとに“プロセス（ステップ＋依存＋所要日数）”をテンプレから展開し、ゴール日から逆算で期限を自動算出。進捗/成果物を紐づけて管理。
- **ユーザ**：個人～小規模チームから導入可（後で組織権限へ拡張）。
- **非機能の最小値**：単一テナント/役割2種（管理者・一般）、監査ログ簡易、休日カレンダー日本版。
- **技術方針（仮）**：SPA(React/Next)＋API(Typescript/Node)＋DB(PostgreSQL)＋ジョブキュー（Bull/Redis）。まずは**通常のWeb/DB**として堅実に。
- **スケジュール算出**：ゴール基準・前工程基準の双方をサポート、営業日計算/休日考慮、依存解決。初期は**決定的アルゴリズム**（LLMなし）。

---

## 段階計画（全体像）

### Phase 0：要件定義＆ドメイン設計（~1–2週）
**目的**：迷わないプロト設計の骨格を固める  
**タスク**
- 業務ユースケース3本を選定（例：営業、採用、オンボーディング）
- 用語集と**ドメインモデル（エンティティ/関係）**確定  
- 画面フローと**紙モック**  
- スケジューリング仕様v1（ゴール逆算、営業日計算、依存）  
**成果物/DoD**：要件ドキュメント、ERD、画面遷移図、擬似コード

### Phase 1：データモデル＆APIの骨格（~1–2週）
**目的**：テンプレ→インスタンス展開までの最小API  
**タスク**
- スキーマ実装（PostgreSQL、マイグレーション）
- API：テンプレCRUD、案件作成、**展開API**
- 営業日/休日テーブル＆関数
- 単体テスト  
**DoD**：Postmanで“テンプレ登録→案件展開→期限付与”が再現できる

### Phase 2：MVP UI（~2–3週）
**目的**：内部利用できる最小UI  
**タスク**
- テンプレ編集UI（順序/依存のドラッグ&ドロップ、所要日数/基準）
- 案件詳細UI（ステップタイムライン、担当者、期限、状態）
- **再展開**（ゴール日変更や遅延時の再計算）
- 成果物添付、コメント、通知メール  
**DoD**：デモシナリオで**一連の操作がUIだけで完結**

### Phase 3：カレンダー/ガント＆安定化（~2週）
**目的**：実運用に必要な可視化と使い勝手  
**タスク**
- ガント表示/カレンダー表示
- 一括更新、検索/フィルタ、監査ログ
- パフォーマンス最適化  
**DoD**：案件100件/ステップ1万規模でストレスなく操作可

### Phase 4：チーム化・権限（~2週）
**目的**：小規模チーム導入  
**タスク**
- 権限（Admin/Editor/Viewer）
- 共有テンプレ、ロールによる自動アサイン
- CSVインポート/エクスポート  
**DoD**：2～10名で同時利用可能

### Phase 5：運用指標＆ふりかえり（~1週）
**目的**：価値の見える化  
**タスク**
- KPI：リードタイム、期限遵守率、遅延頻出ステップ
- 週次レポート  
**DoD**：改善余地が見える“レポート”が定期で出る

---

## コア仕様の要点

### 1) スケジュール逆算の決定仕様
- 入力：`goalDate`, `StepTemplates[]`
- 手順（擬似コード）
  1. トポロジカル順にステップを解決
  2. 基準に応じて期限計算
  3. 休日調整、循環検出
  4. ロック済タスクは固定  
- 出力：`StepInstances[]`

### 2) データ（ミニERDの骨子）
- `process_templates`
- `step_templates`
- `cases`
- `steps`
- `artifacts`
- `holidays`

### 3) 画面（MVPに必要な3点）
- テンプレ編集
- 案件詳細
- ガント/カレンダー

---

## 判断ゲート（Gate）
- **Gate A（Phase 0→1）**：要件合意
- **Gate B（Phase 1→2）**：API一連動作確認
- **Gate C（Phase 2→3）**：UI運用可能
- **Gate D（Phase 4→5）**：権限/監査完了
- **ローンチ条件**：期限遵守率≥80%

---

## リスクと対策
- **再計算の破壊性**：ロック機構＋差分プレビュー
- **休日/営業日差**：カレンダー単位で切替
- **依存の複雑化**：DAG限定
- **運用定着**：CSVインポート＆外部連携

---

## ロードマップのAI追加方針
1) 成果物ドラフト生成
2) テンプレ改善提案
3) 案件起点の自動抽出
4) 制約ソルバ連携

---

## 直近の実行プラン（2週間）
- **Day 1–2**：ユースケース3本確定、モック作成
- **Day 3–5**：ERD初版、アルゴリズム擬似コード
- **Day 6–8**：DB/マイグレーション、API実装
- **Day 9–12**：UI実装（テンプレ編集、案件詳細）
- **Day 13–14**：結合テスト、デモ
